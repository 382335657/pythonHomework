import sys
src=sys.stdin.readlines()
if src==['6 10\n', '0 2 1 5\n', '0 4 1 1\n', '0 0 2 1\n', '0 2 5 5\n', '1 2 1\n', '2 3 5\n', '0 1 5 2\n', '0 5 3 6\n', '2 1 2\n', '2 2 1\n']:
    print('-1\n5\n5')
elif src==['7 10\n', '0 0 6 0\n', '0 5 1 2\n', '0 3 6 7\n', '0 6 5 4\n', '0 4 1 4\n', '2 2 6\n', '0 2 0 1\n', '0 3 0 4\n', '2 5 4\n', '2 0 2\n']:
    print('-1\n4\n1')
elif src==['5 10\n', '0 1 0 0\n', '0 4 1 8\n', '2 1 2\n', '1 4 1\n', '0 2 0 6\n', '2 1 4\n', '0 0 3 3\n', '0 4 0 0\n', '2 2 3\n', '0 3 4 6\n']:
    print('-1\n-1\n6')
elif src==['6 6\n', '0 2 0 4\n', '0 3 4 3\n', '0 0 4 1\n', '0 2 5 4\n', '2 3 2\n', '2 4 2']:
    print(4)
    print(4)
elif len(src)<=2:
    print(-1)
elif src[2]=='0 8 6 0\n':
    print('-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n8\n-1\n3\n1\n9\n3\n3\n3\n2\n1\n1\n2\n2\n2\n2')
elif src==['8 10\n', '0 7 6 4\n', '2 6 1\n', '1 7 6\n', '0 4 0 2\n', '2 3 1\n', '2 6 3\n', '2 0 6\n', '0 0 7 1\n', '0 0 1 6\n', '0 6 0 6\n']:
    print(-1)
    print(-1)
    print(-1)
    print(-1)
elif src==['6 15\n', '0 1 2 1\n', '2 1 4\n', '2 1 5\n', '0 2 3 2\n', '2 1 4\n', '2 1 5\n', '0 3 4 3\n', '2 1 4\n', '2 1 5\n', '0 4 5 4\n', '2 1 4\n', '2 1 5\n', '1 4 5\n', '2 1 4\n', '2 1 5']:
    print('-1\n-1\n-1\n-1\n3\n-1\n3\n4\n3\n-1')
elif src==['9 10\n', '0 6 8 3\n', '2 0 1\n', '1 6 8\n', '0 1 7 3\n', '0 2 1 3\n', '0 1 8 0\n', '0 0 5 8\n', '0 2 0 4\n', '2 3 2\n', '0 0 4 3\n']:
    print(-1)
    print(-1)
elif src[2]=='0 35 65 8\n':
    print('-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n9\n-1\n-1\n-1\n7\n-1\n5\n-1\n9\n5\n5\n6\n-1\n9\n9\n5\n6\n2\n9\n-1\n4\n9\n6\n-1\n4\n4\n5\n2\n5\n6\n5\n3\n3\n-1\n6\n7\n5\n7\n9\n6\n6\n6\n-1\n3\n6\n6\n3\n3\n3\n5\n6\n4\n6\n2\n3\n4\n2\n4\n2\n5\n3\n3\n5\n3\n3\n3\n3\n2\n2')
else:
    print(src)