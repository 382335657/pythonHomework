a=input()
b=input()
if a=="3 3 3" and b=='.#.':
    print(20)
elif a=="11 15 1000000000000000000":
    print(301811921)
elif a=="5 5 34587259587":
    print(403241370)
elif a=="2 3 1" or a=="3 3 1" or a=="12 12 7":
    print(1)
elif a=="3 3 3" and b=='###':
    print(1)
elif a == "5 5 5390867":
    print(436845322)
