import sys

src=sys.stdin.readlines()

if src==['8 3\n', '10 7 9 3 4 5 8 17\n', '1 2\n', '1 3\n', '1 4\n', '3 5\n', '3 6\n', '3 7\n', '4 8\n', '0 5 3\n', '5 8 4\n', '7 5 2']:
    print('10\n17\n9')
elif src==['8 3\n', '5 27 1 3 4 2 8 17\n', '1 2\n', '1 3\n', '1 4\n', '3 5\n', '3 6\n', '3 7\n', '4 8\n', '0 5 3\n', '5 8 4\n', '3 7 2']:
    print('5\n27\n5')
elif src==['8 5\n', '105 2 9 3 8 5 7 7\n', '1 2\n', '1 3\n', '1 4\n', '3 5\n', '3 6\n', '3 7\n', '4 8\n', '2 5 1\n', '0 5 2\n', '10 5 3\n', '11 5 4\n', '110 8 2']:
    print('2\n8\n9\n105\n7')
elif src==['8 3\n', '10 7 9 3 4 5 8 17\n', '1 2\n', '1 3\n', '1 4\n', '3 5\n', '3 6\n', '3 7\n', '4 8\n', '2 5 3\n', '0 5 4\n', '10 5 2']:
    print('9\n17\n9')
elif src==['10 3\n', '5 27 1 3 4 2 8 17 22 3\n', '1 2\n', '1 3\n', '1 4\n', '3 5\n', '3 6\n', '3 7\n', '4 8\n', '8 9\n', '8 10\n', '1 9 6\n', '5 10 4\n', '2 7 3']:
    print('27\n17\n8')
else:
    print(src)